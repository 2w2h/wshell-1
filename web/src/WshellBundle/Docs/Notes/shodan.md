### Что такое

Для начала вспомним такое понятие, как "интернет вещей":

    Интернет вещей (англ. Internet of Things, IoT) — концепция вычислительной сети физических объектов («вещей»),
    оснащённых встроенными технологиями для взаимодействия друг с другом или с внешней средой...

Так вот, Shodan - это поисковик для "интернета вещей". Shodan ищет любые устройства подключенные 
к Сети: маршрутизаторы, web-камеры, телевизоры, принтеры; при желании можно найти и 
более специфичные устройства: детские радионяни, сети светофоров(?), системы управления на предприятиях.
Во всяком случае, так пишут в Интернетах =)


### Немножко истории (копипаста)

Специализированная поисковая система Shodan была создана уроженцем Швейцарии Джоном Мэтерли в 2009 году
и изначально задумывалась как средство поиска подключённых к интернету устройств конкурентов,
рассчитанное на производителей оборудования — таких как Cisco или Juniper.
Название Shodan было позаимствовано из компьютерного шутера середины девяностых System Shock,
где так назывался искусственный суперразум Sentient Hyper-Optimized Data Access Network - «Разумная
гипероптимизированная сеть доступа к данным».

В 17-летнем возрасте будущий создатель Shodan перебрался к тётке, работавшей стюардессой,
в Сан-Диего, где сначала поступил в местный колледж, а затем окончил факультет биоинформатики
Калифорнийского университета. Получив диплом, Мэтерли устроился в суперкомпьютерный центр при университете,
где занимался созданием базы данных белков, одновременно подрабатывая в качестве программиста.
Наконец, в 2009 году он начал работу над Shodan, которая в итоге довольно быстро окупилась,
и появившиеся средства позволили увеличить количество поисковых роботов и улучшить результаты системы.

Вопреки своему первоначальному предназначению, Shodan стала главным инструментом специалистов по безопасности,
исследователей, правоохранительных органов и, конечно же, хакеров, используемым для обнаружения подключённых
к интернету уязвимых устройств, в том числе и тех, которые вообще не должны иметь выхода во Всемирную сеть.

«Google ищет сайты, а я ищу устройства», — объясняет Джон Мазерли.

Поисковик использует freemium-модель. Бесплатный поисковый запрос выдаст вам только 10 результатов.
Около 10 000 пользователей выкладывают до $20 за один запрос, показывающий 10 000 результатов.
Десятки корпоративных пользователей — это фирмы, занимающиеся компьютерной безопасностью, — 
платят каждый год пятизначную сумму за доступ ко всей базе данных Мазерли, куда занесено 1,5 
миллиарда устройств, подключенных к сети.

### Внутри

Разделы
https://exploits.shodan.io
https://scanhub.shodan.io/
maps

### Практика

Сервис практически бесполезен, если на нем не зарегистрироваться. Рекомендую сделать это заранее,
т.к. подтверждение аккаунта падает на почту не сразу, мне например пришло только через X дней.

Фильтры указываются непосредственно в строке запроса:

* country: Страна (двухбуквенный идентификатор)
* city: Город. Лучше использовать в комбинации со страной, Ведь Лондон и в США есть =)
* geo: Географические координаты. Пример: 32.8,-117,50 (50 это радиус в км. По умолчанию = 5)
* hostname: Любая часть доменного имени. Пример: .de
* net: Поиск по подмаске в CIDR нотации. Пример: 216.219.143.0/24
* os: Поиск по операционной системе. windows, linux, cisco и другие.
* port: Поиск по открытым портам. Не любые, но список приличный, все основные сервисы есть.
* before/after: Указать ограничение по дате. Пример: before:15/6/2014

Результат можно сохранить в XML ([Пример](http://www.shodanhq.com/export_sample.xml)).
В этом есть большой практический смысл. Например, если нам нужно будет часто искать
в каком-нибудь подмножестве устройств (например, только в конкретном городе) то эффективнее
сначала выбрать это подмножество в локальный кэш, а потом уже делать с ним все что нужно.
Сохранить можно до 1кк найденных бланков, пачками ("credits") по 10к бланков.

### Developer API

Зарегистрированный пользователь может получить ключ доступа к API Shodan.
API есть 2 видов - REST(т.е. на основе простых HTTP запросов на определенные URL), 
расширяющее функционал обычного поиска и потоковое API, позволяющее получать те данные, которые
собираются Shodan в режиме реального времени. Важно знать, что потоковое API экспериментальное и 
возвращает лишь 1% реально собираемых данных.

Клиентов много, на любой вкус: https://developer.shodan.io/api/clients
REST API: https://developer.shodan.io/api
Stream API: https://developer.shodan.io/api/stream

А ещё есть API к базе эксплоитов =)
https://developer.shodan.io/api/exploits/rest

### Additions

Блог и твиттер Джона, главный источник новой инфы о Shodan:
https://shodanio.wordpress.com/
https://twitter.com/achillean

http://www.youtube.com/watch?feature=player_embedded&v=5cWck_xcH64
И блог:
http://atenlabs.com/blog/
http://vimeo.com/13465839

https://www.defcon.org/images/defcon-18/dc-18-presentations/Schearer/DEFCON-18-Schearer-SHODAN.pdf

Дэн Тентлер, специалист по вопросам безопасности, консультировавший Twitter, создал программу
под названием Eagleeye, которая обнаруживает камеры со слабой защитой при помощи Shodan,
подключается к ним и делает скриншоты. Тентлер нашел почти миллион уязвимых камер.

Можно воспользоваться Shodan для проверки уязвимости ваших устройств: просто введите в поисковую 
строку запрос «net:IP-AДРЕС» c IP-адресами соответствующих девайсов.
